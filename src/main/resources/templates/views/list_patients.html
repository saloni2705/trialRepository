<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Patient Management System</title>
<link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
    crossorigin="anonymous">
</head>
<body>
    
    
    <nav class="navbar navbar-expand-sm bg-primary navbar-dark">
      <a class="navbar-brand" th:href="@{/home}">Home</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="collapsibleNavbar">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" th:href="@{/add}">New Patient</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" th:href="@{/patients}">Patient List</a>
          </li>    
        </ul>
      </div>  
    </nav>

    <div class="jumbotron text-center" style="margin-bottom:0;">
      <h1>Patient Management System</h1>
      <p>In this project, you can manage patient data!</p> 
    </div>
    
    <div class="container" style="margin-top:30px">
      <div class="container">
        <h3>Available Patients</h3>
      </div>
      
      <div class="container">
        <p>All available patients are displayed here.</p>
        <div class="input-group mb-3">
            <input type="text" class="form-control" id="searchInput" placeholder="Search patient">
            <div class="input-group-append">
                <button class="btn btn-primary" type="button" id="searchButton">Search</button>
                <button class="btn btn-secondary" type="button" id="clearButton">Clear</button>
            </div>
        </div>
        <table class="table table-striped table-info">
            <thead class="table-dark">
              <tr class="table-active">
                <th>ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Gender</th>
                <th>City</th>
                <th>Email</th>
                <th>Mobile</th>
                <th>Medical History</th>
                <th>Fees Paid</th>
                <th>Update</th>
                 <th>Report</th>
                <th>Delete</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="patient: ${patients}">
                <td th:text="${patient.id}">Patient Id</td>
                <td th:text="${patient.firstName}">First Name</td>
                <td th:text="${patient.lastName}">Last Name</td>
                <td th:text="${patient.gender}">Gender</td>
                <td th:text="${patient.city}">City</td>
                <td th:text="${patient.email}">Email</td>
                <td th:text="${patient.mobile}">Mobile</td>
                <td th:text="${patient.medicalHistory}">Medical History</td>
                <td th:text="${patient.feesPaid}">Fees Paid</td>
                <td>
                    <a th:href="@{/patient/update/{id}(id=${patient.id})}" class="btn btn-info">Edit</a>
                </td>
                <td>
                    <a th:href="@{/patient/view-report/{id}(id=${patient.id})}" class="btn btn-primary">Report</a>
                </td>
                <td>
                    <a th:href="@{/patient/delete/{id}(id=${patient.id})}" class="btn btn-danger">Delete</a>
                </td>
              </tr>
            </tbody>
        </table>
      </div>
    </div>
    
    <div class="jumbotron text-center" style="margin-bottom:0">
      <p></p>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-u9jAN3QiwOQd8aF+dM8Xy5vDHvq20JXbY+5gkd5Of7gR9zU6fszn0EZkY3hswJ7K"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    
    <script>
        // Function to filter the table rows based on the search input
        document.getElementById('searchButton').addEventListener('click', function() {
            const keyword = document.getElementById('searchInput').value;
            filterTableRows(keyword);
        });

        document.getElementById('clearButton').addEventListener('click', function() {
            document.getElementById('searchInput').value = '';
            filterTableRows('');
        });

        // Function to filter the table rows based on the search input
        function filterTableRows(keyword) {
            var table = document.getElementsByTagName("table")[0];
            var tr = table.getElementsByTagName("tr");
            for (var i = 0; i < tr.length; i++) {
                if (i === 0) {
                    tr[i].style.display = ""; // Show table heading row
                } else {
                    var td = tr[i].getElementsByTagName("td");
                    var match = false;
                    for (var j = 0; j < td.length; j++) {
                        if (td[j]) {
                            var txtValue = td[j].textContent || td[j].innerText;
                            if (txtValue.toUpperCase().indexOf(keyword.toUpperCase()) > -1) {
                                match = true;
                                break;
                            }
                        }
                    }
                    if (match) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }
    </script>
</body>
</html>
